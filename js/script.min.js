window.addEventListener("DOMContentLoaded",(function(){document.addEventListener("click",(function(e){e.target.classList.contains("search__icon")?document.querySelector(".search").classList.toggle("_active"):!e.target.closest(".search")&&document.querySelector(".search._active")&&document.querySelector(".search").classList.remove("_active")})),document.addEventListener("click",(function(e){document.body.classList.toggle("_lock"),document.querySelector(".menu__icon").classList.toggle("_active"),document.querySelector(".menu__body").classList.toggle("_active"),e.target.closest(".menu__icon")||(document.body.classList.remove("_lock"),document.querySelector(".menu__icon").classList.remove("_active"),document.querySelector(".menu__body").classList.remove("_active"))})),function(e,t){let n;function r(){let r;t?r=new Date(t):console.error("Countdown error: no toCountDate mantioned");let s=new Date,a=Math.floor((r-s)/1e3);const o=a%60,c=Math.floor(a/60%60),i=Math.floor(a/3600%24),l=Math.floor(a/86400),d=document.querySelectorAll(e);d.length>0&&d.forEach((e=>{e.querySelector(".days")&&(e.querySelector(".days .num").textContent=l),e.querySelector(".hours")&&(e.querySelector(".hours .num").textContent=i),e.querySelector(".minutes")&&(e.querySelector(".minutes .num").textContent=c),e.querySelector(".seconds")&&(e.querySelector(".seconds .num").textContent=o),l<=0&&i<=0&&c<=0&&o<=0&&(clearInterval(n),e.textContent="The timer is over")}))}e&&t&&(n=setInterval(r,1e3)),r()}(".countdown","31 Dec 2023");new Swiper(".swiper",{loop:!0,spaceBetween:15,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loopAdditionalSlides:1,autoplay:{delay:5e3,reverseDirection:!1,disableOnInteraction:!1},keyboard:{enabled:!0},breakpoints:{480:{slidesPerView:2},768:{slidesPerView:3},992:{slidesPerView:4}}});const e=new Swiper(".slider-product__block",{slidesPerView:1,keyboard:{enabled:!0}});document.querySelectorAll(".product-nav__item").forEach(((t,n)=>{t.setAttribute("data-index",n),t.addEventListener("click",(t=>{const n=parseInt(t.currentTarget.dataset.index);e.slideTo(n)}))}));const t=document.querySelector(".items-catalog"),n=document.querySelector(".main-catalog__grid"),r=document.querySelector(".main-catalog__list");n&&(n.classList.add("_active"),n.addEventListener("click",(()=>{n.classList.add("_active"),r.classList.remove("_active"),t.classList.remove("_details-active")}))),r&&r.addEventListener("click",(()=>{r.classList.add("_active"),n.classList.remove("_active"),t.classList.add("_details-active")})),function(){let e=document.getElementsByClassName("items-catalog__favourite");for(let t=0;t<e.length;t++){e[t].addEventListener("click",(function(e){e.target.closest(".items-catalog__favourite").classList.toggle("active")}))}}()})),function(){class e{static patternName=/^[a-zA-Z]+$/;static patternMail=/^[_a-z0-9-\+-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i;static patternPhone=/^\+?[78][-\(]?\d{3}\)?-?\d{3}-?\d{2}-?\d{2}$/;static patternPostcode=/^[A-Z0-9]+$/;static patternAddress=/^[A-Z0-9]+$/;static patternTown=/^[a-zA-Z]+$/;static patternCountry=/^[a-zA-Z]+$/;static errorMess=["Empty input field","Please enter your real name","Please enter your email","Please enter a valid email address","Please enter a valid number","Please enter a valid postcode","Please enter a valid address","Please enter your town","Please enter your country"];constructor(e){this.form=e,this.fields=this.form.querySelectorAll(".form__input"),this.btn=this.form.querySelector("[type=submit]"),this.iserror=!1,this.registerEventsHandler()}static getElement(e){return e.parentElement.nextElementSibling}registerEventsHandler(){this.btn.addEventListener("click",this.validForm.bind(this)),this.form.addEventListener("focus",(()=>{const e=document.activeElement;e!==this.btn&&this.cleanError(e)}),!0)}validForm(e){e.preventDefault();const t=new FormData(this.form);let n;for(let e of t.keys())n=this.getError(t,e),0!=n.length&&(this.iserror=!0,this.showError(e,n));this.iserror||this.sendFormData(t)}getError(t,n){let r="";const s={username:()=>{0!=t.get("username").length&&0!=e.patternName.test(t.get("username"))||(r=e.errorMess[1])},username2:()=>{0!=t.get("username2").length&&0!=e.patternName.test(t.get("username2"))||(r=e.errorMess[1])},username3:()=>{0!=t.get("username3").length&&0!=e.patternName.test(t.get("username3"))||(r=e.errorMess[1])},usersubject:()=>{0!=t.get("usersubject").length&&0!=e.patternName.test(t.get("usersubject"))||(r=e.errorMess[0])},usermail:()=>{0==t.get("usermail").length?r=e.errorMess[2]:0==e.patternMail.test(t.get("usermail"))&&(r=e.errorMess[3])},userphone:()=>{0!=t.get("userphone").length&&0!=e.patternPhone.test(t.get("userphone"))||(r=e.errorMess[4])},postcode:()=>{0!=t.get("postcode").length&&0!=e.patternPostcode.test(t.get("postcode"))||(r=e.errorMess[5])},address:()=>{0!=t.get("address").length&&0!=e.patternAddress.test(t.get("address"))||(r=e.errorMess[6])},town:()=>{0!=t.get("town").length&&0!=e.patternTown.test(t.get("town"))||(r=e.errorMess[7])},country:()=>{0!=t.get("country").length&&0!=e.patternCountry.test(t.get("country"))||(r=e.errorMess[8])}};return n in s&&s[n](),r}showError(t,n){const r=this.form.querySelector(`[name=${t}]`),s=e.getElement(r);r.classList.add("form__input-error"),s.innerHTML=n,s.style.display="block"}cleanError(t){const n=e.getElement(t);t.classList.remove("form__input-error"),n.removeAttribute("style"),this.iserror=!1}sendFormData(e){let t=new XMLHttpRequest;t.open("POST","/sendmail.php",!0),t.onreadystatechange=()=>{4===t.readyState&&t.status},t.send(e)}}const t=document.querySelectorAll("[name=feedback]");if(t)for(let n of t){new e(n)}}();const rangeInput=document.querySelectorAll(".price__range input"),priceInput=document.querySelectorAll(".price__value input"),range=document.querySelector(".price__progress");let priceGap=100;priceInput.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(priceInput[0].value),n=parseInt(priceInput[1].value);n-t>=priceGap&&n<=rangeInput[1].max&&("price__field-min"===e.target.className?(rangeInput[0].value=t,range.style.left=t/rangeInput[0].max*100+"%"):(rangeInput[1].value=n,range.style.right=100-n/rangeInput[1].max*100+"%"))}))})),rangeInput.forEach((e=>{e.addEventListener("input",(e=>{let t=parseInt(rangeInput[0].value),n=parseInt(rangeInput[1].value);n-t<priceGap?"price__range-min"===e.target.className?rangeInput[0].value=n-priceGap:rangeInput[1].value=t+priceGap:(priceInput[0].value=t,priceInput[1].value=n,range.style.left=t/rangeInput[0].max*100+"%",range.style.right=100-n/rangeInput[1].max*100+"%")}))}));const showMore=document.querySelector(".show-more"),catalogItemLength=document.querySelectorAll(".items-catalog__item").length;let items=6;showMore&&showMore.addEventListener("click",(()=>{items+=3;const e=Array.from(document.querySelector(".items-catalog").children).slice(0,items);e.forEach((e=>e.classList.add("is-visible"))),e.length===catalogItemLength&&(showMore.style.display="none")}));const counters=document.querySelectorAll(".counter");counters&&counters.forEach((e=>{e.addEventListener("click",(e=>{const t=e.target;if(t.closest(".counter__button")){let e=parseInt(t.closest(".counter").querySelector("input").value);t.classList.contains("counter__button-plus")?e++:--e,e<=0&&(e=0),t.closest(".counter").querySelector("input").value=e}}))}));let navTabsItem=document.querySelectorAll(".nav-tabs__item"),tabContentItem=document.querySelectorAll(".tab");function activeTab(){navTabsItem.forEach((function(e){e.classList.remove("is-active")})),this.classList.add("is-active"),activeTabContent(this.getAttribute("data-tab"))}function activeTabContent(e){tabContentItem.forEach((function(t){t.classList.contains(e)?t.classList.add("is-active"):t.classList.remove("is-active")}))}navTabsItem.forEach((function(e){e.addEventListener("click",activeTab)}));let modalReviews=document.querySelector(".modal-reviews"),modalOverlay=document.querySelector("#modal-overlay"),closeButton=document.querySelector("#close-button");const modalImage=modalReviews.querySelector(".modal-reviews__img"),modalDescription=modalReviews.querySelector(".modal-reviews__descr");document.addEventListener("click",(e=>{if(!e.target.matches(".product__container .tab__button"))return;const t=e.target.closest(".product__container"),n=t.querySelector(".info-product__title"),r=t.querySelector(".product-nav__img");modalDescription.textContent=n.textContent,modalImage.src=r.src,modalReviews.classList.add("modal__active"),modalOverlay.classList.add("modal__active")})),closeButton.addEventListener("click",(function(){modalReviews.classList.remove("modal__active"),modalOverlay.classList.remove("modal__active")}));const modalBtns=document.querySelectorAll("._modal-open"),modals=document.querySelectorAll("._modal"),body=document.body;function openModal(e){e.classList.add("_active"),body.classList.add("_locked")}function closeModal(e){(e.target.classList.contains("modal-close")||e.target.closest(".modal-close")||e.target.classList.contains("modal-bg"))&&(e.target.closest("._modal").classList.remove("_active"),body.classList.remove("_locked"))}modalBtns.forEach((e=>{e.addEventListener("click",(e=>{let t=e.target.dataset.modalOpen;modals.forEach((n=>{n.dataset.modal!=t&&n.dataset.modal!=e.target.closest("._modal-open").dataset.modalOpen||openModal(n)}))}))})),modals.forEach((e=>{e.addEventListener("click",(e=>{closeModal(e)}))})),window.addEventListener("keydown",(e=>{modals.forEach((t=>{"Escape"===e.key&&t.classList.contains("_active")&&(t.classList.remove("_active"),body.classList.remove("_lock"))}))}));const ratings=document.querySelectorAll(".rating");function initRatings(){let e,t;for(let e=0;e<ratings.length;e++){n(ratings[e])}function n(e){r(e),s(),e.classList.contains("rating_set")&&function(e){const n=e.querySelectorAll(".rating__item");for(let o=0;o<n.length;o++){const c=n[o];c.addEventListener("mouseenter",(function(t){r(e),s(c.value)})),c.addEventListener("mouseleave",(function(e){s()})),c.addEventListener("click",(function(n){r(e),e.dataset.ajax?a(c.value,e):(t.innerHTML=o+1,s())}))}}(e)}function r(n){e=n.querySelector(".rating__active"),t=n.querySelector(".rating__value")}function s(n=t.innerHTML){const r=n/.05;e.style.width=`${r}%`}async function a(e,n){if(!n.classList.contains("rating_sending")){n.classList.add("rating_sending");let r=await fetch("rating.json",{method:"GET",body:JSON.stringify({userRating:e}),headers:{"content-type":"application/json"}});if(r.ok){const e=(await r.json()).newRating;t.innerHTML=e,s(),n.classList.remove("rating_sending")}else alert("Ошибка"),n.classList.remove("rating_sending")}}}function checkOrdering(e){if(1==e.checked){let t=document.querySelectorAll(".form-checkout__radio");for(let e=0;e<t.length;e++)t[e].checked=!1;e.checked=!0}}ratings.length>0&&initRatings();
